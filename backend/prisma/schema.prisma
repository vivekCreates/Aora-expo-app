generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        Int      @id @default(autoincrement())
  username  String
  email     String   @unique
  password  String
  avatar    String?

  posts     Post[]
  saved     SavedPost[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("users")
}


model Post {
  id             Int      @id @default(autoincrement())
  title          String
  video          String
  thumbnailImage String @map("thumbnail_image")

  userId         Int
  user           User     @relation(fields: [userId], references: [id])

  savedBy        SavedPost[] 

  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  @@map("posts")
}


model SavedPost {
  userId Int
  postId Int

  user   User @relation(fields: [userId], references: [id])
  post   Post @relation(fields: [postId], references: [id])

  savedAt DateTime @default(now()) @map("saved_at")

  @@id([userId, postId])  
  @@index([userId])
  @@index([postId])
  @@map("saved_posts")
}
